<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Onyx ‚Äî Store</title>
<style>
  /* --- Reset & base --- */
  *{box-sizing:border-box;margin:0;padding:0}
  html,body{height:100%}
  body{
    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    background:#000010; color:#fff;
    overflow:hidden;
  }

  /* canvas & nebula */
  #star-canvas{position:fixed;inset:0;z-index:0}
  .nebula{position:fixed;inset:0;z-index:0;pointer-events:none;
    background:
      radial-gradient(600px 400px at 10% 20%, rgba(120,0,255,0.06), transparent 10%),
      radial-gradient(600px 400px at 90% 80%, rgba(0,120,255,0.05), transparent 10%);
    filter:blur(22px); opacity:0.95; mix-blend-mode:screen;
    animation:nebmove 18s linear infinite;
  }
  @keyframes nebmove{0%{transform:translateY(0)}50%{transform:translateY(-30px)}100%{transform:translateY(0)}}

  /* header (large) */
  header{position:relative;z-index:3;display:flex;justify-content:space-between;align-items:center;padding:22px 36px;
    background:linear-gradient(90deg, rgba(110,0,255,0.12), rgba(255,0,170,0.05));backdrop-filter: blur(6px);
  }
  header h1{font-size:34px;letter-spacing:1px;color:#ffd6ff;text-shadow:0 0 18px rgba(255,150,255,0.06)}
  .cart-button{
    background:linear-gradient(90deg,#fff,#f3f3f3); color:#5c0088; border:none; padding:12px 18px; border-radius:12px;
    font-weight:800; cursor:pointer; font-size:18px; box-shadow:0 8px 28px rgba(140,0,255,0.08);
  }

  /* discord claim banner (keeps present) */
  .claim-banner{position:relative;z-index:3;margin:18px auto;max-width:1200px;padding:16px 20px;border-radius:12px;
    border:1px solid rgba(255,0,120,0.14); background:linear-gradient(90deg, rgba(255,10,120,0.06), rgba(255,120,180,0.02));
    text-align:center;font-weight:800;color:#ffd7ea; box-shadow:0 10px 30px rgba(255,0,140,0.03);
  }
  .claim-banner a{color:#ffd0ff;text-decoration:underline}

  /* main layout (larger) */
  .main{position:relative;z-index:2;display:flex;gap:28px;max-width:1400px;margin:18px auto;padding:0 28px 80px}
  .sidebar{width:300px;background:rgba(12,4,30,0.6);padding:20px;border-radius:14px;border:1px solid rgba(120,0,255,0.12);
    box-shadow:0 18px 60px rgba(20,0,60,0.5);backdrop-filter:blur(6px)}
  .sidebar button{display:block;width:100%;margin-bottom:14px;padding:14px;border-radius:12px;border:none;
    background:linear-gradient(90deg,#7e00ff,#ff1599);color:white;font-weight:900;font-size:18px;cursor:pointer;
    box-shadow:0 8px 26px rgba(140,0,255,0.12);transition:transform .14s}
  .sidebar button:hover{transform:translateY(-5px)}

  .products{flex:1;display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:28px}

  /* product card bigger */
  .product{
    background:linear-gradient(180deg, rgba(40,6,70,0.85), rgba(10,3,30,0.8));
    border-radius:16px;padding:20px;border:1px solid rgba(160,0,255,0.10);
    box-shadow:0 18px 60px rgba(0,0,0,0.7);transform-origin:center;animation:cardIn .5s ease both;
  }
  @keyframes cardIn{from{transform:translateY(12px) scale(.98);opacity:0}to{transform:none;opacity:1}}
  .product img{width:100%;height:220px;object-fit:cover;border-radius:12px;margin-bottom:14px;background:linear-gradient(180deg,#222,#111)}
  .product h3{font-size:20px;margin-bottom:8px}
  .product p{font-size:18px;color:#e8e0ff;margin-bottom:12px;font-weight:700}
  .product .actions{display:flex;gap:12px;align-items:center}
  .add-btn{flex:1;padding:14px;border-radius:12px;border:none;background:linear-gradient(90deg,#ff66ff,#9c00ff);
    color:#120017;font-weight:900;font-size:17px;cursor:pointer;transition:transform .12s}
  .add-btn:hover{transform:translateY(-5px)}
  .price-tag{font-weight:900;color:#ffd7ff;font-size:18px}

  /* intro overlay (big & centered) */
  .intro{position:fixed;inset:0;z-index:6;display:flex;align-items:center;justify-content:center;
    background:radial-gradient(circle at center, rgba(0,0,0,0.55), rgba(0,0,0,0.85));backdrop-filter:blur(6px)}
  .intro-card{width:min(820px,94%);background:linear-gradient(180deg, rgba(15,6,35,0.95), rgba(10,3,35,0.96));
    border-radius:16px;padding:34px;text-align:center;border:1px solid rgba(160,0,255,0.10);box-shadow:0 28px 90px rgba(10,0,40,0.8)}
  .intro h2{font-size:36px;margin-bottom:10px;color:#ffd6ff}
  .choices{display:flex;gap:22px;justify-content:center;margin-top:18px;flex-wrap:wrap}
  .choice{padding:18px 26px;border-radius:14px;border:2px solid rgba(255,255,255,0.04);
    background:linear-gradient(90deg,#6b00ff,#ff2288);font-weight:900;font-size:20px;color:white;cursor:pointer}

  /* modal */
  .modal{position:fixed;inset:0;z-index:12;display:none;align-items:center;justify-content:center;background:linear-gradient(180deg, rgba(0,0,0,0.6), rgba(0,0,0,0.85));padding:26px}
  .modal-card{width:520px;background:linear-gradient(180deg, rgba(20,4,60,0.95), rgba(10,3,35,0.95));border-radius:14px;padding:18px;border:1px solid rgba(180,0,255,0.12);box-shadow:0 30px 90px rgba(0,0,0,0.8)}
  .checkout-item{display:flex;justify-content:space-between;padding:12px;border-radius:10px;background:rgba(255,255,255,0.02);margin-bottom:8px}
  .checkout-footer{display:flex;justify-content:space-between;align-items:center;margin-top:12px}
  .buy-btn{padding:12px 18px;border-radius:12px;border:none;background:linear-gradient(90deg,#ff66ff,#9c00ff);color:#120017;font-weight:900;font-size:18px;cursor:pointer}
  .cancel-btn{padding:10px 14px;border-radius:10px;border:none;background:rgba(255,255,255,0.06);color:#fff;cursor:pointer}

  /* flying star */
  .fly-star{position:fixed;z-index:20;font-size:26px;pointer-events:none;transition:transform 800ms cubic-bezier(.2,.9,.3,1),opacity 300ms}

  /* responsive */
  @media (max-width:1000px){
    .sidebar{width:100%;display:flex;gap:12px;overflow-x:auto}
    .main{flex-direction:column}
    .products{grid-template-columns:repeat(auto-fill,minmax(240px,1fr))}
    .modal-card{width:92%}
    .product img{height:160px}
  }
</style>
</head>
<body>

<!-- ====== CONFIG: replace this with your actual discord invite link ====== -->
<script>const DISCORD_INVITE = "https://discord.gg/your-invite-here";</script>

<canvas id="star-canvas"></canvas>
<div class="nebula" aria-hidden="true"></div>

<header>
  <h1>Onyx</h1>
  <button class="cart-button" onclick="openCart()">üõí Cart (<span id="cart-count">0</span>)</button>
</header>

<div class="claim-banner" role="status">
  ‚ö†Ô∏è To claim purchased items, please join our <a href="#" id="discord-link">Discord server</a>.
</div>

<!-- Intro -->
<div id="intro" class="intro" role="dialog" aria-modal="true">
  <div class="intro-card">
    <h2>What are you looking for?</h2>
    <p style="color:#e8d6ff;font-weight:700;margin-top:6px;font-size:16px">Pick one to view matching items.</p>
    <div class="choices" style="margin-top:20px">
      <button class="choice" onclick="selectMode('grow')">Grow a garden stuff</button>
      <button class="choice" onclick="selectMode('design')">Server designing</button>
    </div>
  </div>
</div>

<!-- Main layout -->
<div class="main" id="main-content" aria-hidden="true">
  <aside class="sidebar" id="category-list" aria-label="Categories">
    <!-- categories inserted here -->
    <button onclick="resetIntro()">Back to choices</button>
  </aside>

  <section class="products" id="products" aria-live="polite">
    <!-- products inserted here -->
  </section>
</div>

<!-- Checkout modal -->
<div id="cart-modal" class="modal" role="dialog" aria-modal="true">
  <div class="modal-card">
    <h2 style="color:#ffd6ff;margin-bottom:10px">Checkout</h2>
    <div id="cart-items" style="max-height:320px;overflow:auto;margin-bottom:10px"></div>

    <div style="display:flex;gap:12px;align-items:center;justify-content:space-between">
      <div style="display:flex;gap:12px;align-items:center">
        <label for="payment-select" style="font-weight:800;color:#e6d6ff">Payment:</label>
        <select id="payment-select" style="padding:10px;border-radius:10px;border:none;font-weight:800">
          <option value="paypal">PayPal</option>
          <option value="roblox">Roblox</option>
        </select>
      </div>
      <div id="cart-total" style="font-weight:900;color:#ffd7ff;font-size:20px">Total: $0.00</div>
    </div>

    <div class="checkout-footer">
      <button class="buy-btn" onclick="buyItems()">Buy</button>
      <button class="cancel-btn" onclick="closeCart()">Close</button>
    </div>
  </div>
</div>

<!-- sound (optional) -->
<audio id="click-sound" src="click.mp3" preload="auto"></audio>

<script>
/* ---------------------------
   Starfield canvas
   --------------------------- */
const canvas = document.getElementById('star-canvas');
const ctx = canvas.getContext('2d');
let W = canvas.width = innerWidth;
let H = canvas.height = innerHeight;
window.addEventListener('resize', ()=>{W=canvas.width=innerWidth;H=canvas.height=innerHeight; initStars();});

let stars=[];
const STAR_COUNT = Math.floor((innerWidth*innerHeight)/30000) + 80;
function rand(a,b){return Math.random()*(b-a)+a}
function initStars(){
  stars=[];
  for(let i=0;i<STAR_COUNT;i++){
    stars.push({x:Math.random()*W,y:Math.random()*H,z:rand(0.2,1.2),r:rand(0.4,1.8),dx:rand(-0.03,0.03),dy:rand(-0.02,0.02),tw:Math.random()*1.6});
  }
}
initStars();
let t=0;
function draw(){
  ctx.clearRect(0,0,W,H);
  // subtle overlay gradient
  const g=ctx.createLinearGradient(0,0,W,H); g.addColorStop(0,'rgba(255,100,200,0.01)'); g.addColorStop(1,'rgba(0,100,255,0.01)');
  ctx.fillStyle=g; ctx.fillRect(0,0,W,H);
  for(const s of stars){
    const tw = Math.sin(t*0.02*s.tw)*0.6+0.8;
    const size = s.r*tw*s.z;
    ctx.beginPath();
    ctx.fillStyle = `rgba(255,255,255,${0.5*s.z*tw})`;
    ctx.arc(s.x,s.y,Math.max(0.2,size),0,Math.PI*2); ctx.fill();
    s.x += s.dx*(1+0.6*s.z);
    s.y += s.dy*(1+0.6*s.z);
    if(s.x<-10) s.x=W+10; if(s.x>W+10) s.x=-10;
    if(s.y<-10) s.y=H+10; if(s.y>H+10) s.y=-10;
  }
  t++; requestAnimationFrame(draw);
}
draw();

/* ---------------------------
   PRODUCTS (PLACEHOLDERS)
   All product names are "Placeholder Product X"
   Categories per mode are defined below
   --------------------------- */
const PRODUCTS = {
  grow: {
    "Seeds": [
      { id: "g-s-1", name: "Placeholder Product 1", price: "2.50", img: null },
      { id: "g-s-2", name: "Placeholder Product 2", price: "3.00", img: null }
    ],
    "Tools": [
      { id: "g-t-1", name: "Placeholder Product 3", price: "6.00", img: null },
      { id: "g-t-2", name: "Placeholder Product 4", price: "4.50", img: null }
    ],
    "Decor": [
      { id: "g-d-1", name: "Placeholder Product 5", price: "8.00", img: null },
      { id: "g-d-2", name: "Placeholder Product 6", price: "5.50", img: null }
    ]
  },
  design: {
    "Themes": [
      { id: "d-th-1", name: "Placeholder Product 7", price: "6.00", img: null },
      { id: "d-th-2", name: "Placeholder Product 8", price: "7.50", img: null }
    ],
    "Icons": [
      { id: "d-i-1", name: "Placeholder Product 9", price: "3.50", img: null },
      { id: "d-i-2", name: "Placeholder Product 10", price: "4.00", img: null }
    ],
    "Kits": [
      { id: "d-k-1", name: "Placeholder Product 11", price: "12.00", img: null },
      { id: "d-k-2", name: "Placeholder Product 12", price: "25.00", img: null }
    ]
  }
};

/* ---------------------------
   State
   --------------------------- */
let currentMode = null;
let currentCategory = null;
let cart = [];

/* Utility: safe click sound */
function playClick(){
  const a = document.getElementById('click-sound'); if(a && a.play){ try{ a.play(); }catch(e){} }
}

/* Create a simple SVG placeholder data URL for images */
function placeholderDataURL(text, w=800, h=600, bg='#241233', fg='#ffd6ff'){
  const svg = `<svg xmlns='http://www.w3.org/2000/svg' width='${w}' height='${h}' viewBox='0 0 ${w} ${h}'>
    <rect width='100%' height='100%' fill='${bg}' rx='12'/>
    <g font-family='Segoe UI, Tahoma, Verdana' font-weight='700' fill='${fg}' font-size='32' text-anchor='middle'>
      <text x='50%' y='50%'>${text}</text>
    </g>
  </svg>`;
  return 'data:image/svg+xml;utf8,' + encodeURIComponent(svg);
}

/* Render categories into sidebar */
function renderCategories(){
  const catList = document.getElementById('category-list');
  catList.innerHTML = '';
  // back button
  const backBtn = document.createElement('button'); backBtn.textContent = 'Back to choices';
  backBtn.onclick = resetIntro; catList.appendChild(backBtn);
  if(!currentMode) return;
  const cats = Object.keys(PRODUCTS[currentMode]);
  cats.forEach(cat => {
    const b = document.createElement('button');
    b.textContent = cat;
    b.onclick = ()=>{ playClick(); showProducts(cat); };
    catList.appendChild(b);
  });
}

/* Show products for category (or all categories) */
function showProducts(category){
  currentCategory = category || null;
  const container = document.getElementById('products');
  container.innerHTML = '';
  if(!currentMode) return;
  let list = [];
  if(category === 'all' || !category){
    Object.values(PRODUCTS[currentMode]).forEach(arr=>list=list.concat(arr));
  } else {
    list = PRODUCTS[currentMode][category] || [];
  }
  if(list.length === 0){
    container.innerHTML = `<div style="padding:26px;background:rgba(255,255,255,0.02);border-radius:12px">No items</div>`; return;
  }
  list.forEach((prod, i) => {
    const card = document.createElement('div'); card.className='product';
    // if no img specified, use data URL
    const imgSrc = prod.img || placeholderDataURL('Image',800,500);
    card.innerHTML = `
      <img src="${imgSrc}" alt="${prod.name}" data-id="${prod.id}">
      <h3>${prod.name}</h3>
      <p class="price-tag">$${parseFloat(prod.price).toFixed(2)}</p>
      <div class="actions">
        <button class="add-btn" data-id="${prod.id}">Add to Cart</button>
      </div>
    `;
    // add listener for button & enable star animation
    container.appendChild(card);
    const btn = card.querySelector('.add-btn');
    btn.addEventListener('click', ()=>animateAddToCart(prod, card.querySelector('img')));
  });
}

/* Intro selection */
function selectMode(mode){
  playClick();
  currentMode = mode;
  document.getElementById('intro').style.display = 'none';
  document.getElementById('main-content').setAttribute('aria-hidden','false');
  renderCategories();
  showProducts('all');
}

/* Back to intro */
function resetIntro(){
  playClick();
  currentMode = null;
  currentCategory = null;
  cart = [];
  updateCartCount();
  document.getElementById('intro').style.display = 'flex';
  document.getElementById('main-content').setAttribute('aria-hidden','true');
  document.getElementById('products').innerHTML = '';
  renderCategories();
}

/* Update cart badge */
function updateCartCount(){
  document.getElementById('cart-count').textContent = cart.length;
}

/* Animate star from image to cart, then add to cart */
function animateAddToCart(product, imgEl){
  playClick();
  // get start position: center of image
  const imgRect = imgEl.getBoundingClientRect();
  const startX = imgRect.left + imgRect.width/2;
  const startY = imgRect.top + imgRect.height/2;
  // get cart button pos
  const cartBtn = document.querySelector('.cart-button');
  const cartRect = cartBtn.getBoundingClientRect();
  const endX = cartRect.left + cartRect.width/2;
  const endY = cartRect.top + cartRect.height/2;

  // create flying star element
  const star = document.createElement('div');
  star.className = 'fly-star';
  star.style.left = startX + 'px';
  star.style.top = startY + 'px';
  star.style.transform = 'translate(-50%,-50%) scale(1)';
  star.style.opacity = '1';
  star.innerHTML = '‚≠ê';
  document.body.appendChild(star);

  // force reflow then animate to cart
  requestAnimationFrame(()=>{
    const dx = endX - startX;
    const dy = endY - startY;
    star.style.transform = `translate(${dx}px, ${dy}px) scale(.3)`;
    star.style.transition = 'transform 800ms cubic-bezier(.2,.9,.3,1), opacity 300ms';
  });

  // After animation ends, remove star and add to cart & bump count
  setTimeout(()=>{
    star.style.opacity = '0';
    setTimeout(()=>{ if(star && star.parentNode) star.parentNode.removeChild(star); },300);
    // add to cart now
    cart.push(product);
    updateCartCount();
    // small bounce on cart button
    cartBtn.animate([{transform:'translateY(0)'},{transform:'translateY(-8px)'},{transform:'translateY(0)'}],{duration:300,easing:'ease'});
  },850);
}

/* Open cart modal and render items + total */
function openCart(){
  playClick();
  const modal = document.getElementById('cart-modal');
  const items = document.getElementById('cart-items'); items.innerHTML = '';
  if(cart.length===0){
    items.innerHTML = `<div style="padding:18px;color:#ddd">Your cart is empty.</div>`;
    document.getElementById('cart-total').textContent = 'Total: $0.00';
  } else {
    // compute total safely (digit-by-digit)
    let total = 0;
    for(let i=0;i<cart.length;i++){
      const p = parseFloat(cart[i].price);
      if(!isNaN(p)) total += p;
      const row = document.createElement('div'); row.className='checkout-item';
      row.innerHTML = `<div style="font-weight:800">${cart[i].name}</div>
        <div style="display:flex;gap:10px;align-items:center"><div style="font-weight:900">$${parseFloat(cart[i].price).toFixed(2)}</div>
        <button style="background:none;border:none;color:#ff9bbd;cursor:pointer;font-weight:800" onclick="removeItem(${i})">‚úñ</button></div>`;
      items.appendChild(row);
    }
    document.getElementById('cart-total').textContent = `Total: $${total.toFixed(2)}`;
  }
  modal.style.display = 'flex';
}

/* Close cart */
function closeCart(){
  playClick();
  document.getElementById('cart-modal').style.display = 'none';
}

/* Remove item from cart */
function removeItem(index){
  playClick();
  if(index>=0 && index<cart.length) cart.splice(index,1);
  updateCartCount();
  openCart();
}

/* Buy: redirect to DISCORD_INVITE (replace with your invite). Payment method is selectable but redirect is to the server link as requested. */
function buyItems(){
  playClick();
  if(cart.length===0){ alert('Your cart is empty.'); return; }
  // calc total defensively
  let total = 0;
  for(let i=0;i<cart.length;i++){ const p=parseFloat(cart[i].price); if(!isNaN(p)) total+=p; }
  const method = document.getElementById('payment-select').value;
  const ok = confirm(`Total: $${total.toFixed(2)}\nPayment method: ${method}\n\nYou will be redirected to the Discord invite to complete claiming.`);
  if(!ok) return;
  // redirect to Discord invite (replace DISCORD_INVITE constant above with your link)
  window.location.href = typeof DISCORD_INVITE === 'string' ? DISCORD_INVITE : 'https://discord.gg/your-invite-here';
}

/* initial UI state */
function init(){
  // put categories (empty until selection)
  renderCategories();
  // link discord link to invite constant
  const dl = document.getElementById('discord-link'); if(dl){
    dl.href = typeof DISCORD_INVITE === 'string' ? DISCORD_INVITE : '#';
    dl.target = '_blank';
  }
}
init();

/* keyboard: Esc returns to intro */
document.addEventListener('keydown', e=>{ if(e.key==='Escape') resetIntro(); });
</script>
</body>
</html>
